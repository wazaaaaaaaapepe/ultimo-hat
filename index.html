<!DOCTYPE html>
<html>
<head>
  <title>Último Hat LIMITED en Roblox</title>
</head>
<body>
  <h1>Último Hat LIMITED (Roblox o UGC Limited) publicado</h1>
  <div id="hatInfo">Cargando...</div>

  <script>
    fetch("https://catalog.roproxy.com/v1/search/items/details?Category=11&SortType=3&Limit=30")
      .then(response => {
        if (!response.ok) {
          throw new Error('Error en la respuesta de la API: ' + response.status);
        }
        return response.json();
      })
      .then(data => {
        if (data.data && data.data.length > 0) {
          // Filtrar solo los Limiteds auténticos, tanto de Roblox como UGC
          const limitedItems = data.data.filter(item => {
            // Verificamos que el ítem tenga un collectibleItemId (es un Limited) y un precio mayor a 500 Robux
            // También verificamos que el creador sea Roblox o sea un UGC Limited (con precio adecuado)
            const isRobloxCreator = item.creator.id === 1; // Creador es Roblox
            const isLimitedUGC = item.collectibleItemId && item.price > 500; // UGC Limiteds con precio mayor a 500

            return (isRobloxCreator || isLimitedUGC); // Solo mostrar si es un Limited de Roblox o un UGC Limited válido
          });

          if (limitedItems.length === 0) {
            throw new Error("No se encontraron Limiteds recientemente.");
          }

          const item = limitedItems[0]; // El más reciente Limited (puede ser de Roblox o UGC)
          
          // Asegurarnos de que tenga una imagen
          const thumbnailUrl = item.thumbnail?.url || 'https://www.roblox.com/favicon.ico';

          // Verificamos si tiene un precio válido
          const price = item.price ? item.price : "Precio no disponible";

          const hatHtml = `
            <p><strong>Nombre:</strong> ${item.name}</p>
            <p><strong>Precio:</strong> ${price}</p>
            <p><strong>Link:</strong> <a href="https://www.roblox.com/catalog/${item.id}" target="_blank">Ver en Roblox</a></p>
            <img src="${thumbnailUrl}" width="150">
          `;
          document.getElementById("hatInfo").innerHTML = hatHtml;
        } else {
          throw new Error('No se encontraron datos del sombrero');
        }
      })
      .catch(err => {
        document.getElementById("hatInfo").innerText = "Error al obtener datos: " + err.message;
        console.error(err);
      });
  </script>
</body>
</html>
