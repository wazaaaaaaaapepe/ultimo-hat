<!DOCTYPE html>
<html>
<head>
  <title>Último Hat LIMITED publicado</title>
</head>
<body>
  <h1>Último hat LIMITED (incluyendo UGC Limiteds)</h1>
  <div id="hatInfo">Cargando...</div>

  <script>
    async function obtenerLimitedReciente() {
      try {
        const response = await fetch("https://catalog.roproxy.com/v1/search/items/details?Category=11&SortType=3&Limit=30");
        if (!response.ok) throw new Error('Error en la respuesta de la API: ' + response.status);

        const data = await response.json();
        if (!data.data || data.data.length === 0) throw new Error("No se encontraron ítems.");

        // Filtrar solo los ítems que son realmente Limited o LimitedU (UGC)
        const limiteds = data.data.filter(item => item.collectibleItemId);

        if (limiteds.length === 0) throw new Error("No se encontraron Limiteds recientemente.");

        const item = limiteds[0];
        const thumbnailUrl = item.thumbnail?.url || 'https://www.roblox.com/favicon.ico';

        const html = `
          <p><strong>Nombre:</strong> ${item.name}</p>
          <p><strong>Precio:</strong> ${item.price || "Gratis"}</p>
          <p><strong>Tipo:</strong> ${item.creator.hasVerifiedBadge ? "Roblox" : "UGC"}</p>
          <p><strong>Link:</strong> <a href="https://www.roblox.com/catalog/${item.id}" target="_blank">Ver en Roblox</a></p>
          <img src="${thumbnailUrl}" width="150">
        `;

        document.getElementById("hatInfo").innerHTML = html;
      } catch (error) {
        document.getElementById("hatInfo").innerText = "Error al cargar datos: " + error.message;
        console.error(error);
      }
    }

    obtenerLimitedReciente();
  </script>
</body>
</html>
