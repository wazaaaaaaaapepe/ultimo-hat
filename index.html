<!DOCTYPE html>
<html>
<head>
  <title>Últimos Limiteds de Rolimons</title>
</head>
<body>
  <h1>Últimos Limiteds según Rolimons</h1>
  <div id="hatInfo">Cargando...</div>

  <script>
    fetch("https://www.rolimons.com/itemapi/itemdetails")
      .then(response => {
        if (!response.ok) throw new Error("Error en la API de Rolimons");
        return response.json();
      })
      .then(data => {
        const items = data.items;

        // Convertimos los items a un array con sus IDs
        const itemArray = Object.entries(items).map(([id, info]) => ({
          id,
          name: info[0],
          value: info[1],
          rap: info[2],
          demand: info[3],
          trend: info[4],
          collectible: info[8] // true si es Limited
        }));

        // Filtrar solo Limiteds
        const limiteds = itemArray.filter(item => item.collectible);

        // Ordenar por ID descendente (para mostrar los más nuevos)
        limiteds.sort((a, b) => Number(b.id) - Number(a.id));

        // Mostrar los 5 primeros
        const html = limiteds.slice(0, 5).map(item => {
          return `
            <div style="margin-bottom: 20px;">
              <p><strong>Nombre:</strong> ${item.name}</p>
              <p><strong>Valor estimado:</strong> ${item.value || "Desconocido"}</p>
              <p><strong>RAP:</strong> ${item.rap}</p>
              <p><strong>Demanda:</strong> ${item.demand || "?"}</p>
              <p><strong>Tendencia:</strong> ${item.trend || "?"}</p>
              <p><a href="https://www.roblox.com/catalog/${item.id}" target="_blank">Ver en Roblox</a></p>
              <img src="https://www.roblox.com/asset-thumbnail/image?assetId=${item.id}&width=150&height=150&format=png">
            </div>
          `;
        }).join("");

        document.getElementById("hatInfo").innerHTML = html;
      })
      .catch(error => {
        document.getElementById("hatInfo").innerText = "Error: " + error.message;
        console.error(error);
      });
  </script>
</body>
</html>
